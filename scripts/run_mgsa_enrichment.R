library(mgsa)
library(biomaRt)

gaf <- readGAF(filename = "~/Desktop/gene_association.mgi", aspect = "P");

angio.genes <- c("ENSMUSG00000028635","ENSMUSG00000054779","ENSMUSG00000042379","ENSMUSG00000053175",
                 "ENSMUSG00000030406","ENSMUSG00000040280","ENSMUSG00000071637","ENSMUSG00000021091",
                 "ENSMUSG00000042284","ENSMUSG00000037225","ENSMUSG00000020427","ENSMUSG00000039167",
                 "ENSMUSG00000025515","ENSMUSG00000001930","ENSMUSG00000087168","ENSMUSG00000054435",
                 "ENSMUSG00000028036","ENSMUSG00000027435","ENSMUSG00000036912","ENSMUSG00000026678",
                 "ENSMUSG00000026414","ENSMUSG00000085304","ENSMUSG00000019846","ENSMUSG00000037411",
                 "ENSMUSG00000031844","ENSMUSG00000024912","ENSMUSG00000054690","ENSMUSG00000091705",
                 "ENSMUSG00000107256","ENSMUSG00000047867","ENSMUSG00000042622","ENSMUSG00000030790",
                 "ENSMUSG00000026814","ENSMUSG00000000489","ENSMUSG00000022146","ENSMUSG00000056481",
                 "ENSMUSG00000037010","ENSMUSG00000031616","ENSMUSG00000032495","ENSMUSG00000073409",
                 "ENSMUSG00000037820","ENSMUSG00000053113","ENSMUSG00000000317","ENSMUSG00000032911",
                 "ENSMUSG00000108616","ENSMUSG00000023905","ENSMUSG00000035105","ENSMUSG00000030562",
                 "ENSMUSG00000073599","ENSMUSG00000051435","ENSMUSG00000034205","ENSMUSG00000016494",
                 "ENSMUSG00000073421","ENSMUSG00000031871","ENSMUSG00000026193","ENSMUSG00000012819",
                 "ENSMUSG00000015312","ENSMUSG00000035385","ENSMUSG00000026822","ENSMUSG00000032035",
                 "ENSMUSG00000024440","ENSMUSG00000089984","ENSMUSG00000026628","ENSMUSG00000001131",
                 "ENSMUSG00000030847","ENSMUSG00000025492","ENSMUSG00000045667","ENSMUSG00000016087",
                 "ENSMUSG00000067212","ENSMUSG00000031465","ENSMUSG00000004665","ENSMUSG00000031805",
                 "ENSMUSG00000026547","ENSMUSG00000029307","ENSMUSG00000045382","ENSMUSG00000050370",
                 "ENSMUSG00000090958","ENSMUSG00000061232","ENSMUSG00000034394","ENSMUSG00000004891",
                 "ENSMUSG00000036256","ENSMUSG00000032135","ENSMUSG00000020303","ENSMUSG00000015852",
                 "ENSMUSG00000020689","ENSMUSG00000020695","ENSMUSG00000032554","ENSMUSG00000031207",
                 "ENSMUSG00000030218","ENSMUSG00000039116","ENSMUSG00000041974","ENSMUSG00000021281",
                 "ENSMUSG00000000555","ENSMUSG00000078566","ENSMUSG00000037405","ENSMUSG00000032085",
                 "ENSMUSG00000001473","ENSMUSG00000037868","ENSMUSG00000030123","ENSMUSG00000022500",
                 "ENSMUSG00000004791","ENSMUSG00000032231","ENSMUSG00000024206","ENSMUSG00000046805",
                 "ENSMUSG00000003955","ENSMUSG00000021250","ENSMUSG00000030341","ENSMUSG00000021806",
                 "ENSMUSG00000002699","ENSMUSG00000041782","ENSMUSG00000028195","ENSMUSG00000035783",
                 "ENSMUSG00000029622","ENSMUSG00000060550","ENSMUSG00000046186","ENSMUSG00000029718",
                 "ENSMUSG00000021998","ENSMUSG00000038146","ENSMUSG00000029338","ENSMUSG00000023951",
                 "ENSMUSG00000046768","ENSMUSG00000033491","ENSMUSG00000052837","ENSMUSG00000026247",
                 "ENSMUSG00000043091","ENSMUSG00000001493","ENSMUSG00000031503","ENSMUSG00000000184",
                 "ENSMUSG00000059430","ENSMUSG00000056737","ENSMUSG00000069516","ENSMUSG00000026712",
                 "ENSMUSG00000031103","ENSMUSG00000030111","ENSMUSG00000027907","ENSMUSG00000031799",
                 "ENSMUSG00000040552","ENSMUSG00000036480","ENSMUSG00000042286","ENSMUSG00000028763",
                 "ENSMUSG00000019942","ENSMUSG00000040204","ENSMUSG00000020914","ENSMUSG00000024538",
                 "ENSMUSG00000031004","ENSMUSG00000031375","ENSMUSG00000001228","ENSMUSG00000040152",
                 "ENSMUSG00000041482","ENSMUSG00000016763","ENSMUSG00000006219","ENSMUSG00000027967",
                 "ENSMUSG00000022483");

mouse.mart <- useMart( biomart="ENSEMBL_MART_ENSEMBL", dataset = "mmusculus_gene_ensembl", host="www.ensembl.org" );

ids <- getBM(
  attributes = c("ensembl_gene_id", "mgi_id"),
  filters = "ensembl_gene_id",
  values = angio.genes,
  mart = mouse.mart
  );

fit = mgsa(ids$mgi_id, gaf)

plot(fit)

res = setsResults(fit)
subset(res, estimate > 0.5)

#             inPopulation inStudySet estimate  std.error term                        definition
# GO:0045765          232         22   0.8004          NA regulation of angiogenesis  Any process that modulates the frequency, rate or extent of angiogenesis.